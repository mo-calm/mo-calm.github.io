<script>
    const amapApiKey = 'a74d0f4851c6e2003d5aeeb9e9472f74';

    // 动态加载脚本函数，模拟 JSONP 请求
    function loadScript(url) {
        const script = document.createElement('script');
        script.src = url;
        document.body.appendChild(script);
    }

    // 使用高德地图API根据公司名称查询GPS坐标和邮政编码的回调函数
    function handleAmapResponse(data) {
        console.log('API Response:', data); // 打印API响应内容，调试用
        if (data.status === '1' && data.geocodes && data.geocodes.length > 0) {
            const geocode = data.geocodes[0];
            const [lon, lat] = geocode.location.split(',');
            const postalCode = geocode.adcode;

            document.getElementById("companyGpsResult").innerText = `纬度: ${lat}, 经度: ${lon}`;
            document.getElementById("companyPostalCodeResult").innerText = postalCode || "未找到邮政编码";
        } else {
            document.getElementById("companyGpsResult").innerText = "未找到该公司的GPS坐标";
            document.getElementById("companyPostalCodeResult").innerText = "未找到邮政编码";
        }
    }

    // 根据公司名称获取 GPS 坐标和邮政编码（优先使用高德地图）
    function getCompanyCoordinates() {
        const companyName = encodeURIComponent(document.getElementById("companyName").value);
        const url = `https://restapi.amap.com/v3/geocode/geo?address=${companyName}&key=${amapApiKey}&callback=handleAmapResponse`;
        loadScript(url);
    }

    // 使用高德地图API根据地址查询GPS坐标和邮政编码
    function getAddressInfo() {
        const address = encodeURIComponent(document.getElementById("companyAddress").value);
        const url = `https://restapi.amap.com/v3/geocode/geo?address=${address}&key=${amapApiKey}&callback=handleAmapResponse`;
        loadScript(url);
    }
</script>
